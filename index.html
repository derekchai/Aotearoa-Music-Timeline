<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Example</title>
   <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
     integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
     crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
     integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
     crossorigin=""></script>
  <style>
    body {
      margin: auto;
      font-family: Arial, sans-serif;
      width: 50em;
      background-color: black;
      color: white;
    }

    .container {
      display: flex;
      min-height: 100vh;
    }

    /* Sticky left panel */
    .sticky {
  position: sticky;
  top: 0;
  width: 60%;
  height: 100vh;   /* full height of viewport */
  background-color: black;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 2rem;
  text-align: center;
  padding: 0; /* remove padding so map can fit */
  box-sizing: border-box;
}

#map {
  width: 100%;
  height: 100%;   /* fill the sticky panel */
}

    /* Scrolling steps on the right */
    .steps {
      width: 40%;
    }

    .step {
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      transition: background-color 0.3s;
    }

    .step span {
        background: white;
        color: black;
        box-decoration-break: clone;
        display: inline;

    }

    /* .step.active {
      background-color: lightblue;
    } */

    .visible {
        visibility: visible;
        opacity: 1;
        transition: opacity 0.2s ease-in-out;
    }

    .hidden {
        visibility: hidden;
        opacity: 0;
        transition: visibility 0s 0.2s, opacity 0.2s ease-in-out;
    }

    
  </style>
</head>
<body>
    <h1>My title</h1>
<p>by <strong>DEREK CHAI</strong></p>

<p>
Lorem ipsum dolor sit amet, ipsum qui laboris nisi voluptate id aliqua volupta
te reprehenderit veniam elit nulla laborum quis reprehenderit ea ad eu ut cill
um esse deserunt amet deserunt dolor cillum irure duis consequat veniam sunt c
onsectetur quis laboris adipisicing occaecat dolore aute eiusmod sint anim cul
pa anim nostrud ullamco sit nulla sunt dolor cupidatat non cupidatat in amet a
ute do reprehenderit ad ex labore minim pariatur elit officia ea reprehenderit
 irure cupidatat minim cillum culpa aliqua excepteur laborum commodo velit ips
um anim laborum elit cillum in ullamco ea duis ad in dolor reprehenderit aute 
excepteur dolor minim adipisicing amet ut ea deserunt Lorem aliqua commodo rep
rehenderit minim nisi ut officia elit quis adipisicing commodo culpa pariatur 
nulla voluptate aliquip magna sunt Lorem Lorem elit laborum cillum ea amet com
modo duis cillum incididunt officia quis cillum non sint deserunt id quis aliq
uip reprehenderit non aute reprehenderit deserunt ad elit sit Lorem minim temp
or reprehenderit duis consequat fugiat irure dolor minim fugiat irure tempor u
t aute ullamco consequat fugiat officia officia in ea anim dolore dolor tempor
 amet nulla Lorem commodo nostrud voluptate magna eiusmod commodo sit minim ni
si ex deserunt occaecat non exercitation eu exercitation deserunt ipsum ex qui
s qui aliquip eu proident reprehenderit officia pariatur incididunt sunt aliqu
ip ullamco commodo proident consequat aliquip qui aute Lorem eiusmod irure id 
pariatur cillum nulla laboris magna ea dolor culpa nulla minim enim velit nisi
 sunt dolore labore irure magna minim in fugiat tempor occaecat ipsum occaecat
 et aliqua in excepteur ad aute cupidatat nulla aliquip fugiat ut irure minim 
laborum occaecat nisi ea quis ad amet magna pariatur qui laboris non dolore fu
giat non tempor sint est non labore dolor occaecat culpa aliquip Lorem volupta
te dolor eu amet adipisicing occaecat ad sit laboris minim qui et excepteur cu
pidatat proident aute consectetur ipsum velit veniam enim culpa dolor tempor l
abore nulla et nostrud exercitation adipisicing nostrud non labore exercitatio
n consequat enim id eiusmod aliquip culpa labore anim cupidatat ad officia qui
s ex tempor amet sint dolore ullamco nulla laborum deserunt minim Lorem incidi
dunt culpa ea sit consequat cillum id adipisicing adipisicing exercitation min
im et adipisicing sit anim laboris eu magna pariatur consequat aliqua occaecat
 deserunt magna ex incididunt deserunt amet elit velit ad voluptate tempor inc
ididunt duis aliqua nulla in quis ea voluptate laborum cupidatat Lorem est eli
t officia reprehenderit velit sint ea consectetur ipsum aliqua ut ullamco do e
iusmod in consectetur laborum enim laborum do ex nisi amet voluptate in eiusmo
d veniam exercitation esse excepteur dolore sint cupidatat aute ipsum laboris 
commodo enim commodo reprehenderit magna magna velit magna proident aliquip si
nt reprehenderit commodo proident anim fugiat amet dolore culpa consequat moll
it magna et sint ea duis ut commodo anim mollit sit do amet proident sunt duis
 fugiat ullamco occaecat irure deserunt anim minim sunt nisi qui est labore te
mpor mollit adipisicing dolore minim in cillum ut dolor deserunt id nostrud ul
lamco cillum sit proident culpa eiusmod amet in minim exercitation magna eiusm
od et quis occaecat eiusmod in veniam adipisicing aliqua exercitation commodo 
voluptate labore labore

</p>

<div class="container">
  <div class="sticky" id="sticky-content">
      <div id="map"></div> <!-- only one map now -->
  </div>

  <div class="steps">
    <div class="step" data-content="This is Step 1">
        <span>This is New Zealand. It's a country in the middle of the Pacific.</span>
    </div>
    <div class="step" data-content="Now at Step 2">
        <p>Here is Dunedin.</p>
    </div>
    <div class="step" data-content="Hereâ€™s Step 3">
        <p>This is Auckland. It's the most populous city of New Zealand.</p>
    </div>
    <div class="step" data-content="Finally Step 4">
        <p>Step 4</p>
    </div>
  </div>
</div>

    <p>
        The Dunedin Sound was a movement in the early 1980s. It eventually
        evolved into what we know today as indie rock.
    </p>

  <!-- Scrollama JS -->
  <script src="https://unpkg.com/scrollama"></script>
  <script>
            var map = L.map('map').setView([53, 12], 5);

            // Style URL format in XYZ PNG format; see our documentation for more options
            L.tileLayer('https://tiles.stadiamaps.com/tiles/stamen_toner/{z}/{x}/{y}{r}.png', {
                maxZoom: 20,
                attribution: '&copy; <a href="https://stadiamaps.com/" target="_blank">Stadia Maps</a>, &copy; <a href="https://openmaptiles.org/" target="_blank">OpenMapTiles</a> &copy; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a>',
            }).addTo(map);

            L.marker([-36.8484, 174.7622]).addTo(map)
    .bindPopup('Sky Tower')
    .openPopup();

    const scroller = scrollama();

    scroller
      .setup({
        step: '.step',
        offset: 0.5,
      })
      .onStepEnter((response) => {
        if (response.index == 1) {
            map.flyTo([-45.8795,170.5006], 13, {
                "animate": true,
                duration: 1,
            })
        } else if (response.index == 2) {
            map.flyTo([-36.8509,174.7645], 13, {
                "animate": true,
                duration: 1,
            })
        } else if (response.index == 0) {
            map.flyTo([-40.9006, 174.8860], 5, {
                "animate": true,
                duration: 1,
            })
        } 

        if (response.index <= 2) {
            document.getElementById('map').classList.add('visible');
            document.getElementById('map').classList.remove('hidden');
        } else {
            document.getElementById('map').classList.remove('visible');
            document.getElementById('map').classList.add('hidden');
        }
        

        document.querySelectorAll('.step').forEach(step => step.classList.remove('active'));
        response.element.classList.add('active');

        // const content = response.element.getAttribute('data-content');
        // document.getElementById('sticky-content').textContent = content;
      });

    // Handle window resize
    window.addEventListener('resize', scroller.resize);
  </script>

</body>
</html>